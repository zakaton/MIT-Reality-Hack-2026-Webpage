<html>
  <head>
    <title>Power Pet</title>
    <script src="../src/utils/canvasInput.js"></script>
    <script src="./src/aframe/aframe-master.min.js"></script>
    <script src="./src/aframe/occlude-hand-tracking-controls.js"></script>
    <script src="./src/aframe/grabbable-listener.js"></script>
    <script src="./src/aframe/grabbable-anchor.js"></script>
    <script src="./src/aframe/power-pet.js"></script>
    <script src="./src/aframe/robot.js"></script>
    <script src="./src/aframe/recenter-listener.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.1/dist/aframe-extras.min.js"></script>
    <script src="./src/socket.io/socket.io.min.js"></script>
    <script src="./src/script.js" type="module"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css"
    />
  </head>
  <style>
    .github-fork-ribbon:before {
      background-color: #333;
    }

    #container {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 1rem;
    }
    #sceneContainer {
      display: grid;
      aspect-ratio: 1.3;
      height: 500px;
    }
    #sceneContainer > * {
      width: 100%;
      height: 100%;
      grid-area: 1 / 1;
    }
    .aframe-inspector-opened a-scene,
    .aframe-inspector-opened a-scene canvas {
      position: fixed !important;
      top: 0;
      left: 0;
      width: 100vw !important;
      height: 100vh !important;
      z-index: 9999;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: baseline;
    }
    .containers {
      display: flex;
      flex-direction: column;
    }
    .hidden {
      display: none !important;
    }
  </style>
  <body>
    <a
      class="github-fork-ribbon"
      href="https://github.com/zakaton/MIT-Reality-Hack-2026-Webpage"
      data-ribbon="View on GitHub"
      title="View on GitHub"
      target="_blank"
      >View on GitHub</a
    >

    <nav>
      <a href="/">home</a>
    </nav>
    <h1>Power Pet</h1>
    <div id="container">
      <div id="sceneContainer">
        <img id="sceneBackgroundImage" />
        <video id="sceneBackgroundVideo"></video>
        <video id="sceneBackgroundWebcam"></video>
        <a-scene
          obb-collider="showColliders: false;"
          id="scene"
          embedded
          power-pet="models: #dogModel"
          xr-mode-ui="XRMode: ar"
          light="defaultLightsEnabled: true;"
          grabbable-listener
          device-orientation-permission-ui="enabled: false"
        >
          <a-assets>
            <a-asset-item
              id="anchorModel"
              src="../assets/3d/anchor.glb"
            ></a-asset-item>
            <a-asset-item
              id="dogModel"
              src="../assets/3d/pets/dog.glb"
            ></a-asset-item>
          </a-assets>

          <a-light type="ambient"></a-light>

          <a-camera
            id="camera"
            look-controls="enabled: true; magicWindowTrackingEnabled: false;"
            wasd-controls="enabled: true; acceleration: 1;"
            position="0 1.2 0"
          ></a-camera>

          <a-entity id="robot" robot rotation="0 180 0" position="0 0.8 -0.3">
            <a-entity class="debug" visible="true">
              <a-box
                height="0.0508"
                width="0.1778"
                depth="0.1651"
                position="0 0.0254 0"
                color="red"
              ></a-box>
            </a-entity>

            <a-entity
              data-angle-type="steppers"
              data-angle-index="0"
              data-angle-axis="y"
              data-angle-sign="-1"
            >
              <a-entity class="debug" visible="true">
                <a-box
                  height="0.1397"
                  width="0.04445"
                  depth="0.04445"
                  position="0 0.06985 0"
                  color="blue"
                ></a-box>
              </a-entity>

              <a-entity
                position="0 0.1397 0"
                data-angle-type="servos"
                data-angle-index="0"
                data-angle-axis="x"
              >
                <a-entity class="debug" visible="true">
                  <a-box
                    height="0.12065"
                    width="0.04445"
                    depth="0.04445"
                    position="0 0.060 0"
                    color="green"
                  ></a-box>
                </a-entity>

                <a-entity
                  position="0 0.12065 0"
                  data-angle-type="servos"
                  data-angle-index="1"
                  data-angle-axis="x"
                >
                  <a-entity class="debug" visible="true">
                    <a-box
                      height="0.0889"
                      width="0.04445"
                      depth="0.04445"
                      position="0 0.04445 0"
                      color="orange"
                    ></a-box>
                  </a-entity>

                  <a-entity position="0 0.0889 0">
                    <a-entity class="debug" visible="true">
                      <a-box
                        height="0.0889"
                        width="0.0889"
                        depth="0.06985"
                        color="purple"
                        visible="true"
                      ></a-box>
                    </a-entity>

                    <a-entity
                      position="0 -0.05 0.01"
                      id="powerPet"
                      power-pet="model: dogModel;"
                    ></a-entity>
                  </a-entity>
                </a-entity>
              </a-entity>
            </a-entity>
          </a-entity>

          <a-entity
            id="anchor"
            anchored="persistent: true"
            position="0.2 1 -0.3"
            grabbable
            grabbable-anchor
            visible="false"
          >
            <a-entity gltf-model="#anchorModel"></a-entity>
          </a-entity>

          <a-entity
            id="leftController"
            meta-touch-controls="hand: left"
            laser-controls="hand: left"
            raycaster="objects: [data-world-mesh]; far: 5"
          >
            <a-entity
              position="0.006 0 -0.02"
              obb-collider="size: 0.06"
            ></a-entity>
          </a-entity>

          <a-entity
            id="rightController"
            meta-touch-controls="hand: right"
            laser-controls="hand: right"
            raycaster="objects: [data-world-mesh]; far: 5"
          >
            <a-entity
              position="-0.006 0 -0.02"
              obb-collider="size: 0.06"
            ></a-entity>
          </a-entity>

          <a-entity
            id="leftHand"
            hand-tracking-grab-controls="hand: left;"
            occlude-hand-tracking-controls
          ></a-entity>
          <a-entity
            id="rightHand"
            hand-tracking-grab-controls="hand: right;"
            occlude-hand-tracking-controls
          ></a-entity>

          <a-sky color="#ECECEC" hide-on-enter-ar></a-sky>
        </a-scene>
      </div>
      <div id="unoQConnectionContainer" class="container">
        <h2>Uno Q Connection</h2>
        <label>
          address
          <input
            id="unoQAddress"
            size="26"
            type="text"
            placeholder="https://powerpet.local:7000"
          />
        </label>
        <button id="toggleUnoQConnection">connect</button>
        <label>
          auto connect
          <input type="checkbox" id="unoQAutoConnect" disabled />
        </label>
      </div>
    </div>
  </body>
</html>
